Результат = "";

Запрос = Новый Запрос("ВЫБРАТЬ
                      |	ИнформационныеКартыКонтактнаяИнформация.Представление КАК НомерТелефона
                      |ИЗ
                      |	Справочник.ИнформационныеКарты.КонтактнаяИнформация КАК ИнформационныеКартыКонтактнаяИнформация
                      |ГДЕ
                      |	ИнформационныеКартыКонтактнаяИнформация.Ссылка = &Карта
                      |	И ИнформационныеКартыКонтактнаяИнформация.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКонтактнойИнформации.АдресЭлектроннойПочты)
                      |	И ИнформационныеКартыКонтактнаяИнформация.Вид = ЗНАЧЕНИЕ(Справочник.ВидыКонтактнойИнформации.EmailИнформационнойКарты)");


Запрос.УстановитьПараметр("Карта", Карта);

Выборка = Запрос.Выполнить().Выбрать();
Если Выборка.Следующий() Тогда
	Результат = СокрЛП(Выборка.НомерТелефона);
КонецЕсли;

Если Результат = "" Тогда

	Запрос.Текст = "ВЫБРАТЬ
	               |	ФизическиеЛицаКонтактнаяИнформация.Представление КАК НомерТелефона
	               |ИЗ
	               |	Справочник.ИнформационныеКарты КАК ИнформационныеКарты
	               |		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ФизическиеЛица.КонтактнаяИнформация КАК ФизическиеЛицаКонтактнаяИнформация
	               |		ПО ИнформационныеКарты.ВладелецКарты = ФизическиеЛицаКонтактнаяИнформация.Ссылка
	               |ГДЕ
	               |	ИнформационныеКарты.Ссылка = &Карта
	               |	И ФизическиеЛицаКонтактнаяИнформация.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКонтактнойИнформации.АдресЭлектроннойПочты)
	               |	И ФизическиеЛицаКонтактнаяИнформация.Вид = ЗНАЧЕНИЕ(Справочник.ВидыКонтактнойИнформации.EmailФизическогоЛица)
	               |
	               |ОБЪЕДИНИТЬ ВСЕ
	               |
	               |ВЫБРАТЬ
	               |	КонтрагентыКонтактнаяИнформация.Представление
	               |ИЗ
	               |	Справочник.ИнформационныеКарты КАК ИнформационныеКарты
	               |		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Контрагенты.КонтактнаяИнформация КАК КонтрагентыКонтактнаяИнформация
	               |		ПО ИнформационныеКарты.ВладелецКарты = КонтрагентыКонтактнаяИнформация.Ссылка
	               |ГДЕ
	               |	ИнформационныеКарты.Ссылка = &Карта
	               |	И КонтрагентыКонтактнаяИнформация.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКонтактнойИнформации.АдресЭлектроннойПочты)
	               |	И КонтрагентыКонтактнаяИнформация.Вид = ЗНАЧЕНИЕ(Справочник.ВидыКонтактнойИнформации.EmailКонтрагента)
	               |
	               |ОБЪЕДИНИТЬ ВСЕ
	               |
	               |ВЫБРАТЬ
	               |	ПользователиКонтактнаяИнформация.Представление
	               |ИЗ
	               |	Справочник.ИнформационныеКарты КАК ИнформационныеКарты
	               |		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Пользователи.КонтактнаяИнформация КАК ПользователиКонтактнаяИнформация
	               |		ПО ИнформационныеКарты.ВладелецКарты = ПользователиКонтактнаяИнформация.Ссылка
	               |ГДЕ
	               |	ИнформационныеКарты.Ссылка = &Карта
	               |	И ПользователиКонтактнаяИнформация.Тип = ЗНАЧЕНИЕ(Перечисление.ТипыКонтактнойИнформации.АдресЭлектроннойПочты)
	               |	И ПользователиКонтактнаяИнформация.Вид = ЗНАЧЕНИЕ(Справочник.ВидыКонтактнойИнформации.EmailПользователя))";


	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Следующий() Тогда
		Результат = СокрЛП(Выборка.НомерТелефона);
	Иначе
		Результат = "";
	КонецЕсли;
	
КонецЕсли;